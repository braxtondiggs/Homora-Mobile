<ion-header [ngClass]="{'transparent clear-btns': !preview }">
	<ion-navbar>
		<ion-buttons *ngIf="!preview" end>
			<button ion-button icon-only clear>
				<ion-icon name="share"></ion-icon>
			</button>
			<button ion-button icon-only clear>
				<ion-icon name="heart-outline"></ion-icon>
			</button>
		</ion-buttons>
	</ion-navbar>
</ion-header>
<ion-content>
	<div *ngIf="(listing$ | async) as listing;">
		<ion-slides centeredSlides="false" autoplay="5000">
			<ion-slide *ngFor="let image of listing.images">
				<img [attr.src]="image.src" alt="{{listing.title}}" />
			</ion-slide>
			<ion-slide *ngIf="!listing.images">
				<img [attr.src]="DEFAULT_LISTING_IMAGE" alt="Default Image" />
			</ion-slide>
		</ion-slides>
		<div class="listing-header" padding-vertical>
			<h2 class="title md-display-1" *ngIf="listing.title" padding-horizontal no-margin>{{listing.title}}</h2>
			<ion-grid no-padding>
				<ion-row align-items-start padding-horizontal>
					<ion-col>
						<h3 class="price md-display-1" *ngIf="listing.price" no-margin>{{listing.price | currency:'USD':true:'1.0-3'}}<span>/&nbsp;month</span></h3>
						<h4 class="location md-subhead" *ngIf="listing.location.city && listing.location.state" no-margin><ion-icon name="pin"></ion-icon> {{listing.location.city}}, {{listing.location.state}}</h4>
					</ion-col>
					<ion-col (click)="viewProfile(createdBy.$key)" *ngIf="(listing.createdBy$ | async) as createdBy;" col-auto>
						<ion-avatar class="avatar">
							<img [attr.src]="(createdBy.images[0].src) ? createdBy.images[0].src : DEFAULT_USER_IMAGE" alt="{{createdBy.firstName}} {{createdBy.lastName}}">
						</ion-avatar>
						<p class="listing-createdby md-subhead">{{createdBy.firstName}}, {{ today | amDifference: createdBy.birthdate :'years'}}</p>
					</ion-col>
				</ion-row>
				<ion-row class="more-info" align-items-center>
					<ion-col>
						<h3 class="md-subhead" no-margin><ion-icon name="home"></ion-icon>&nbsp;Move-in</h3>
						<p no-margin>{{availability(listing.availability)}}</p>
					</ion-col>
					<ion-col *ngIf="listing.duration">
						<h3 class="md-subhead" no-margin><ion-icon name="calendar"></ion-icon>&nbsp;Duration</h3>
						<p no-margin>{{duration(listing.duration.lower, listing.duration.upper)}}</p>
					</ion-col>
					<ion-col>
						<h3 class="md-subhead" no-margin><ion-icon name="cash"></ion-icon>&nbsp;Deposit</h3>
						<p no-margin>{{listing.deposit | currency:'USD':true:'1.0-3'}}</p>
					</ion-col>
				</ion-row>
			</ion-grid>
			<p class="md-subhead" (click)="readMore(listing.summary)" *ngIf="listing.summary" padding-horizontal>{{listing.summaryTruncated}}<button class="readmore" ion-button clear no-padding>Read More</button></p>
		</div>
		<ion-fab class="interested" *ngIf="!preview && !isUserListing(listing.createdBy.id)" right bottom>
			<button ion-fab (click)="contact(listing.createdBy.id, listing.$key)">
				<ion-icon name="chatbubbles"></ion-icon>
			</button>
		</ion-fab>
		<ion-fab class="submit" *ngIf="preview" right bottom>
			<button ion-fab (click)="submit(listing)">
				<ion-icon name="ios-arrow-forward"></ion-icon>
			</button>
		</ion-fab>
		<ion-fab class="edit" *ngIf="!preview && isUserListing(listing.createdBy.id)" right bottom>
			<button ion-fab (click)="edit(listing.$key)">
				<ion-icon name="create"></ion-icon>
			</button>
		</ion-fab>
	</div>
</ion-content>